{{ define "main" }}
{{ partial "hero.html" . }}

<div class="page-container">
  {{/* Three entry points */}}
  <section class="home-section">
    <div class="card-grid" style="grid-template-columns: repeat(3, 1fr);">
      {{/* Start the Guide */}}
      {{ with site.GetPage "/guide" }}
      <div class="start-here-card">
        <a href="{{ .RelPermalink }}" class="start-here-link">
          <span class="start-here-badge">New to this?</span>
          <h2 style="font-size: var(--text-xl);">Start the Guide</h2>
          <p>A sequential reading path from first principles to productive AI-assisted development.</p>
          <span class="start-here-cta">Begin reading &rarr;</span>
        </a>
      </div>
      {{ end }}

      {{/* Pick a Debate */}}
      {{ with site.GetPage "/debates" }}
      <div class="start-here-card" style="border-color: var(--color-debates);">
        <a href="{{ .RelPermalink }}" class="start-here-link">
          <span class="start-here-badge" style="background: rgba(245,158,11,0.1); color: var(--color-debates);">Dive deeper</span>
          <h2 style="font-size: var(--text-xl);">Pick a Debate</h2>
          <p>{{ len .RegularPages }} open questions where the community genuinely disagrees. Both sides, strongest arguments.</p>
          <span class="start-here-cta" style="color: var(--color-debates);">Explore debates &rarr;</span>
        </a>
      </div>
      {{ end }}

      {{/* Hear from Practitioners */}}
      {{ with site.GetPage "/voices" }}
      <div class="start-here-card" style="border-color: var(--color-voices);">
        <a href="{{ .RelPermalink }}" class="start-here-link">
          <span class="start-here-badge" style="background: rgba(251,113,133,0.1); color: var(--color-voices);">Real voices</span>
          <h2 style="font-size: var(--text-xl);">Practitioner Voices</h2>
          <p>Curated insights from developers who've gone deep with AI coding tools. Real experience, not marketing.</p>
          <span class="start-here-cta" style="color: var(--color-voices);">Read voices &rarr;</span>
        </a>
      </div>
      {{ end }}
    </div>
  </section>

  {{/* What's New â€” from changelog frontmatter */}}
  {{ $changelog := site.GetPage "/changelog" }}
  {{ if and $changelog $changelog.Params.updates }}
  <section class="home-section whats-new">
    <div class="whats-new-header">
      <h2 class="home-section-title">What's New</h2>
      <a href="{{ $changelog.RelPermalink }}" class="whats-new-changelog-link">Full timeline &rarr;</a>
    </div>
    <div class="whats-new-list">
      {{ range first 3 $changelog.Params.updates }}
      <div class="whats-new-entry">
        <div class="whats-new-entry-header">
          <time class="whats-new-date">{{ (time .date).Format "Jan 2" }}</time>
          <span class="whats-new-headline">{{ .headline }}</span>
        </div>
        <ul class="whats-new-details">
          {{ range .details }}
          <li>{{ . }}</li>
          {{ end }}
        </ul>
      </div>
      {{ end }}
    </div>
  </section>
  {{ end }}

  {{/* Practices */}}
  {{ $practices := (site.GetPage "/practices").RegularPages }}
  {{ if $practices }}
  <section class="home-section">
    <div class="home-section-header">
      <h2 class="home-section-title">Practices</h2>
    </div>
    <div class="card-grid{{ if gt (len $practices) 3 }} card-grid--browse{{ end }}">
      {{ range first 3 ($practices.ByWeight) }}
        {{ partial "card.html" . }}
      {{ end }}
      {{ if gt (len $practices) 3 }}
        {{ partial "browse-card.html" (dict "section" (site.GetPage "/practices") "total" (len $practices) "shown" 3 "color" "var(--color-practices)") }}
      {{ end }}
    </div>
  </section>
  {{ end }}

  {{/* Tools */}}
  {{ $tools := (site.GetPage "/tools").RegularPages }}
  {{ if $tools }}
  <section class="home-section">
    <div class="home-section-header">
      <h2 class="home-section-title">Tool Landscape</h2>
    </div>
    <div class="card-grid{{ if gt (len $tools) 3 }} card-grid--browse{{ end }}">
      {{ range first 3 ($tools.ByWeight) }}
        {{ partial "card.html" . }}
      {{ end }}
      {{ if gt (len $tools) 3 }}
        {{ partial "browse-card.html" (dict "section" (site.GetPage "/tools") "total" (len $tools) "shown" 3 "color" "var(--color-tools)") }}
      {{ end }}
    </div>
  </section>
  {{ end }}

  {{/* Evidence */}}
  {{ $evidence := (site.GetPage "/evidence").RegularPages }}
  {{ if $evidence }}
  <section class="home-section">
    <div class="home-section-header">
      <h2 class="home-section-title">Evidence &amp; Case Studies</h2>
    </div>
    <div class="card-grid{{ if gt (len $evidence) 3 }} card-grid--browse{{ end }}">
      {{ range first 3 ($evidence.ByWeight) }}
        {{ partial "card.html" . }}
      {{ end }}
      {{ if gt (len $evidence) 3 }}
        {{ partial "browse-card.html" (dict "section" (site.GetPage "/evidence") "total" (len $evidence) "shown" 3 "color" "var(--color-evidence)") }}
      {{ end }}
    </div>
  </section>
  {{ end }}

  {{/* Landscape */}}
  {{ $landscape := (site.GetPage "/landscape").RegularPages }}
  {{ if $landscape }}
  <section class="home-section">
    <div class="home-section-header">
      <h2 class="home-section-title">Landscape</h2>
    </div>
    <div class="card-grid{{ if gt (len $landscape) 3 }} card-grid--browse{{ end }}">
      {{ range first 3 ($landscape.ByWeight) }}
        {{ partial "card.html" . }}
      {{ end }}
      {{ if gt (len $landscape) 3 }}
        {{ partial "browse-card.html" (dict "section" (site.GetPage "/landscape") "total" (len $landscape) "shown" 3 "color" "var(--color-landscape)") }}
      {{ end }}
    </div>
  </section>
  {{ end }}

  {{/* Latest Sources */}}
  {{ $sources := (site.GetPage "/sources").RegularPages }}
  {{ if $sources }}
  <section class="home-section">
    <div class="home-section-header">
      <h2 class="home-section-title">Latest Sources</h2>
    </div>
    <div class="card-grid{{ if gt (len $sources) 3 }} card-grid--browse{{ end }}">
      {{ range first 3 ($sources.ByDate.Reverse) }}
        {{ partial "card.html" . }}
      {{ end }}
      {{ if gt (len $sources) 3 }}
        {{ partial "browse-card.html" (dict "section" (site.GetPage "/sources") "total" (len $sources) "shown" 3 "color" "var(--color-sources)") }}
      {{ end }}
    </div>
  </section>
  {{ end }}

  {{/* Browse by Topic */}}
  <section class="home-section">
    <h2 class="home-section-title">Browse by Topic</h2>
    <div class="tag-cloud">
      {{ range site.Taxonomies.tags.ByCount }}
        <a href="{{ .Page.RelPermalink }}" class="tag-cloud-item">
          {{ .Page.Title }}
          <span class="tag-count">{{ .Count }}</span>
        </a>
      {{ end }}
    </div>
  </section>
</div>
{{ end }}
